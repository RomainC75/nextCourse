{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/rom/Documents/dev/nextjs/tuto/section10-context/components/input/newsletter-registration.js\";\nimport { useRef, useState, useContext, useEffect } from \"react\";\nimport classes from \"./newsletter-registration.module.css\";\nimport NotificationContext from \"../../store/notification-context\";\n\nfunction NewsletterRegistration() {\n  const {\n    0: isEmailRegistered,\n    1: setIsEmailRegistered\n  } = useState(false);\n  const notificationCtx = useContext(NotificationContext);\n  useEffect(() => {\n    console.log('notification');\n  });\n  const inputRef = useRef();\n\n  function registrationHandler(event) {\n    event.preventDefault();\n    console.log(\"==>\", inputRef.current.value);\n    notificationCtx.showNotification({\n      title: \"Signing up ...\",\n      message: \"Registering for newsletter.\",\n      status: \"pending\"\n    });\n    fetch(\"/api/registration\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        email: inputRef.current.value\n      }),\n      headers: {\n        \"Content-type\": \"application/json\"\n      }\n    }).then(raw => {\n      // fetch!=axios\n      // fetch doen't execute the catch block when receiving a 400/500 status code\n      console.log('xxx');\n\n      if (raw.ok) {\n        return raw.json();\n      }\n\n      raw.json().then(data => {\n        throw new Error(data.message || \"error message\");\n      });\n    }).then(data => {\n      setIsEmailRegistered(true);\n      notificationCtx.showNotification({\n        title: \"Success ! \",\n        message: \"Succesfully registered for newsletter !\",\n        status: \"succes\"\n      });\n    }).catch(err => {\n      notificationCtx.showNotification({\n        title: \"Error ! \",\n        message: err.message || \"Something went wrong !\",\n        status: \"error\"\n      });\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: classes.newsletter,\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Sign up to stay updated!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: registrationHandler,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.control,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          id: \"email\",\n          placeholder: \"Your email\",\n          \"aria-label\": \"Your email\",\n          ref: inputRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"Register\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this), isEmailRegistered && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        color: \"red\"\n      },\n      children: \"REGISTERED\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 29\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 5\n  }, this);\n}\n\nexport default NewsletterRegistration;","map":{"version":3,"sources":["/home/rom/Documents/dev/nextjs/tuto/section10-context/components/input/newsletter-registration.js"],"names":["useRef","useState","useContext","useEffect","classes","NotificationContext","NewsletterRegistration","isEmailRegistered","setIsEmailRegistered","notificationCtx","console","log","inputRef","registrationHandler","event","preventDefault","current","value","showNotification","title","message","status","fetch","method","body","JSON","stringify","email","headers","then","raw","ok","json","data","Error","catch","err","newsletter","control","color"],"mappings":"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","sourcesContent":["import { useRef, useState, useContext, useEffect } from \"react\";\nimport classes from \"./newsletter-registration.module.css\";\n\nimport NotificationContext from \"../../store/notification-context\";\n\nfunction NewsletterRegistration() {\n  const [isEmailRegistered, setIsEmailRegistered] = useState(false);\n  const notificationCtx = useContext(NotificationContext);\n\n  useEffect(()=>{\n    console.log('notification')\n  })\n  \n\n  const inputRef = useRef();\n  function registrationHandler(event) {\n    event.preventDefault();\n    console.log(\"==>\", inputRef.current.value);\n\n    notificationCtx.showNotification({\n      title: \"Signing up ...\",\n      message: \"Registering for newsletter.\",\n      status: \"pending\",\n    });\n\n    fetch(\"/api/registration\", {\n      method: \"POST\",\n      body: JSON.stringify({ email: inputRef.current.value }),\n      headers: {\n        \"Content-type\": \"application/json\",\n      },\n    })\n      .then((raw) => {\n        // fetch!=axios\n        // fetch doen't execute the catch block when receiving a 400/500 status code\n        console.log('xxx')\n        if (raw.ok) {\n          return raw.json();\n        }\n        raw.json().then((data) => {\n          throw new Error(data.message || \"error message\");\n        });\n      })\n      .then((data) => {\n        setIsEmailRegistered(true);\n        notificationCtx.showNotification({\n          title: \"Success ! \",\n          message: \"Succesfully registered for newsletter !\",\n          status: \"succes\",\n        });\n      })\n      .catch((err) => {\n        notificationCtx.showNotification({\n          title: \"Error ! \",\n          message: err.message || \"Something went wrong !\",\n          status: \"error\",\n        });\n      });\n  }\n\n  return (\n    <section className={classes.newsletter}>\n      <h2>Sign up to stay updated!</h2>\n      <form onSubmit={registrationHandler}>\n        <div className={classes.control}>\n          <input\n            type=\"email\"\n            id=\"email\"\n            placeholder=\"Your email\"\n            aria-label=\"Your email\"\n            ref={inputRef}\n          />\n          <button>Register</button>\n        </div>\n      </form>\n      {isEmailRegistered && <p style={{ color: \"red\" }}>REGISTERED</p>}\n    </section>\n  );\n}\n\nexport default NewsletterRegistration;\n"]},"metadata":{},"sourceType":"module"}