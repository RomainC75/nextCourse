{"ast":null,"code":"import { MongoClient } from \"mongodb\";\n\nconst mongoConnect = async res => {\n  const {\n    MongoClient\n  } = require(\"mongodb\");\n\n  const url = \"mongodb+srv://mongoAUse:i6m3jV7kqz8XP2S@cluster0.cl4dl.mongodb.net/nextjs\";\n  const client = new MongoClient(url);\n  await client.connect();\n  console.log(client);\n  return client;\n};\n\nconst mongoEmailRegistrationHandler = async (client, collection, data) => {\n  try {\n    const db = client.db();\n    const ans = await db.collection(collection).insertOne({\n      email: data.email\n    });\n    console.log(\"ans : \", ans);\n    await client.close();\n    return ans;\n  } catch (error) {\n    throw Error(\"cannot insert the document\");\n    return res.status(400).json({\n      message: \"cannot insert the document\"\n    });\n  }\n};\n\nconst mongoCommentSavingHandler = async (client, collection, data) => {\n  try {\n    const db = client.db();\n    const ans = await db.collection().insertOne(data);\n    console.log(\"ans : \", ans);\n    await client.close();\n    return ans;\n  } catch (error) {\n    return res.status(400).json({\n      message: \"cannot insert the document\"\n    });\n  }\n};\n\nconst mongoCommentReadingHandler = async (client, collection, eventId) => {\n  try {\n    const db = client.db();\n    const ans = await db.collection(collection).find({\n      eventId\n    }).toSort({\n      _id: -1\n    }).toArray();\n    console.log(\"==>ans : \", ans);\n    await client.close();\n    return ans;\n  } catch (error) {\n    return res.status(400).json({\n      message: \"cannot get the documents\"\n    });\n  }\n};\n\nexport { mongoEmailRegistrationHandler, mongoCommentSavingHandler, mongoCommentReadingHandler, mongoConnect };","map":{"version":3,"sources":["/home/rom/Documents/dev/nextjs/tuto/section9-apiRoutes/helpers/mongodb.js"],"names":["MongoClient","mongoConnect","res","require","url","client","connect","console","log","mongoEmailRegistrationHandler","collection","data","db","ans","insertOne","email","close","error","Error","status","json","message","mongoCommentSavingHandler","mongoCommentReadingHandler","eventId","find","toSort","_id","toArray"],"mappings":"AAAA,SAASA,WAAT,QAA4B,SAA5B;;AAEA,MAAMC,YAAY,GAAG,MAAOC,GAAP,IAAe;AAClC,QAAM;AAAEF,IAAAA;AAAF,MAAkBG,OAAO,CAAC,SAAD,CAA/B;;AACA,QAAMC,GAAG,GACP,2EADF;AAEA,QAAMC,MAAM,GAAG,IAAIL,WAAJ,CAAgBI,GAAhB,CAAf;AACA,QAAMC,MAAM,CAACC,OAAP,EAAN;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYH,MAAZ;AACA,SAAOA,MAAP;AACD,CARD;;AAUA,MAAMI,6BAA6B,GAAG,OAAOJ,MAAP,EAAeK,UAAf,EAA2BC,IAA3B,KAAoC;AACxE,MAAI;AACF,UAAMC,EAAE,GAAGP,MAAM,CAACO,EAAP,EAAX;AACA,UAAMC,GAAG,GAAG,MAAMD,EAAE,CACjBF,UADe,CACJA,UADI,EAEfI,SAFe,CAEL;AAAEC,MAAAA,KAAK,EAAEJ,IAAI,CAACI;AAAd,KAFK,CAAlB;AAGAR,IAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBK,GAAtB;AACA,UAAMR,MAAM,CAACW,KAAP,EAAN;AACA,WAAOH,GAAP;AACD,GARD,CAQE,OAAOI,KAAP,EAAc;AACd,UAAMC,KAAK,CAAC,4BAAD,CAAX;AACA,WAAOhB,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAArB,CAAP;AACD;AACF,CAbD;;AAeA,MAAMC,yBAAyB,GAAG,OAAOjB,MAAP,EAAeK,UAAf,EAA2BC,IAA3B,KAAoC;AACpE,MAAI;AACF,UAAMC,EAAE,GAAGP,MAAM,CAACO,EAAP,EAAX;AACA,UAAMC,GAAG,GAAG,MAAMD,EAAE,CAACF,UAAH,GAAgBI,SAAhB,CAA0BH,IAA1B,CAAlB;AACAJ,IAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBK,GAAtB;AACA,UAAMR,MAAM,CAACW,KAAP,EAAN;AACA,WAAOH,GAAP;AACD,GAND,CAME,OAAOI,KAAP,EAAc;AACd,WAAOf,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAArB,CAAP;AACD;AACF,CAVD;;AAYA,MAAME,0BAA0B,GAAG,OAAOlB,MAAP,EAAeK,UAAf,EAA2Bc,OAA3B,KAAuC;AACxE,MAAI;AACF,UAAMZ,EAAE,GAAGP,MAAM,CAACO,EAAP,EAAX;AACA,UAAMC,GAAG,GAAG,MAAMD,EAAE,CACjBF,UADe,CACJA,UADI,EAEfe,IAFe,CAEV;AAAED,MAAAA;AAAF,KAFU,EAGfE,MAHe,CAGR;AAAEC,MAAAA,GAAG,EAAE,CAAC;AAAR,KAHQ,EAIfC,OAJe,EAAlB;AAMArB,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBK,GAAzB;AACA,UAAMR,MAAM,CAACW,KAAP,EAAN;AACA,WAAOH,GAAP;AACD,GAXD,CAWE,OAAOI,KAAP,EAAc;AACd,WAAOf,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAArB,CAAP;AACD;AACF,CAfD;;AAiBA,SACEZ,6BADF,EAEEa,yBAFF,EAGEC,0BAHF,EAIEtB,YAJF","sourcesContent":["import { MongoClient } from \"mongodb\";\n\nconst mongoConnect = async (res) => {\n  const { MongoClient } = require(\"mongodb\");\n  const url =\n    \"mongodb+srv://mongoAUse:i6m3jV7kqz8XP2S@cluster0.cl4dl.mongodb.net/nextjs\";\n  const client = new MongoClient(url);\n  await client.connect();\n  console.log(client)\n  return client;\n};\n\nconst mongoEmailRegistrationHandler = async (client, collection, data) => {\n  try {\n    const db = client.db();\n    const ans = await db\n      .collection(collection)\n      .insertOne({ email: data.email });\n    console.log(\"ans : \", ans);\n    await client.close();\n    return ans;\n  } catch (error) {\n    throw Error(\"cannot insert the document\");\n    return res.status(400).json({ message: \"cannot insert the document\" });\n  }\n};\n\nconst mongoCommentSavingHandler = async (client, collection, data) => {\n  try {\n    const db = client.db();\n    const ans = await db.collection().insertOne(data);\n    console.log(\"ans : \", ans);\n    await client.close();\n    return ans;\n  } catch (error) {\n    return res.status(400).json({ message: \"cannot insert the document\" });\n  }\n};\n\nconst mongoCommentReadingHandler = async (client, collection, eventId) => {\n  try {\n    const db = client.db();\n    const ans = await db\n      .collection(collection)\n      .find({ eventId })\n      .toSort({ _id: -1 })\n      .toArray();\n\n    console.log(\"==>ans : \", ans);\n    await client.close();\n    return ans;\n  } catch (error) {\n    return res.status(400).json({ message: \"cannot get the documents\" });\n  }\n};\n\nexport {\n  mongoEmailRegistrationHandler,\n  mongoCommentSavingHandler,\n  mongoCommentReadingHandler,\n  mongoConnect,\n};\n"]},"metadata":{},"sourceType":"module"}