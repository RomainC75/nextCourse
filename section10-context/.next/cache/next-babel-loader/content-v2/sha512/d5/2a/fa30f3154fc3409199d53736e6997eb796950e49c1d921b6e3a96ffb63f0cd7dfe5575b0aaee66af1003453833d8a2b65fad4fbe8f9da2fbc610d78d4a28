{"ast":null,"code":"import { mongoConnect, mongoEmailRegistrationHandler } from \"../../../helpers/mongodb\";\n\nasync function handle(req, res) {\n  let client;\n\n  try {\n    client = await mongoConnect();\n  } catch (error) {\n    return res.status(400).json({\n      message: \"connecting to the db failed\"\n    });\n  }\n\n  console.log(req.body);\n\n  if (req.method === \"POST\") {\n    try {\n      const ans = await mongoEmailRegistrationHandler(client, \"registration\", req.body);\n      return res.status(201).json({\n        message: \"registered\",\n        email: ans\n      });\n    } catch (error) {\n      return res.status(400).json({\n        message: \"inserting email failed\"\n      });\n    }\n  }\n\n  res.status(400).json({\n    message: \"expect a POST request\"\n  });\n}\n\nexport default handle;","map":{"version":3,"sources":["/home/rom/Documents/dev/nextjs/tuto/section10-context/pages/api/registration/index.js"],"names":["mongoConnect","mongoEmailRegistrationHandler","handle","req","res","client","error","status","json","message","console","log","body","method","ans","email"],"mappings":"AAAA,SACEA,YADF,EAEEC,6BAFF,QAGO,0BAHP;;AAKA,eAAeC,MAAf,CAAsBC,GAAtB,EAA2BC,GAA3B,EAAgC;AAC9B,MAAIC,MAAJ;;AACA,MAAI;AACFA,IAAAA,MAAM,GAAG,MAAML,YAAY,EAA3B;AACD,GAFD,CAEE,OAAOM,KAAP,EAAc;AACd,WAAOF,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAArB,CAAP;AACD;;AACDC,EAAAA,OAAO,CAACC,GAAR,CAAYR,GAAG,CAACS,IAAhB;;AACA,MAAIT,GAAG,CAACU,MAAJ,KAAe,MAAnB,EAA2B;AACzB,QAAI;AACF,YAAMC,GAAG,GAAG,MAAMb,6BAA6B,CAC7CI,MAD6C,EAE7C,cAF6C,EAG7CF,GAAG,CAACS,IAHyC,CAA/C;AAKA,aAAOR,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,QAAAA,OAAO,EAAE,YADiB;AAE1BM,QAAAA,KAAK,EAAED;AAFmB,OAArB,CAAP;AAID,KAVD,CAUE,OAAOR,KAAP,EAAc;AACZ,aAAOF,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,QAAAA,OAAO,EAAE;AAAX,OAArB,CAAP;AACH;AACF;;AACDL,EAAAA,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,IAAAA,OAAO,EAAE;AAAX,GAArB;AACD;;AAED,eAAeP,MAAf","sourcesContent":["import {\n  mongoConnect,\n  mongoEmailRegistrationHandler,\n} from \"../../../helpers/mongodb\";\n\nasync function handle(req, res) {\n  let client;\n  try {\n    client = await mongoConnect();\n  } catch (error) {\n    return res.status(400).json({ message: \"connecting to the db failed\" });\n  }\n  console.log(req.body);\n  if (req.method === \"POST\") {\n    try {\n      const ans = await mongoEmailRegistrationHandler(\n        client,\n        \"registration\",\n        req.body\n      );\n      return res.status(201).json({\n        message: \"registered\",\n        email: ans,\n      });\n    } catch (error) {\n        return res.status(400).json({ message: \"inserting email failed\" });\n    }\n  }\n  res.status(400).json({ message: \"expect a POST request\" });\n}\n\nexport default handle;\n"]},"metadata":{},"sourceType":"module"}