{"ast":null,"code":"import { mongoConnect, mongoEmailRegistrationHandler } from \"../../../helpers/mongodb\";\n\nasync function handle(req, res) {\n  let client;\n\n  try {\n    client = await mongoConnect();\n  } catch (error) {\n    return res.status(400).json({\n      message: \"cannot insert the document\"\n    });\n  }\n\n  console.log(req.body);\n\n  if (req.method === \"POST\") {\n    try {\n      const ans = await mongoEmailRegistrationHandler(client, \"registration\", req.body);\n      return res.status(201).json({\n        message: \"registered\",\n        email: ans\n      });\n    } catch (error) {\n      console.log('error ', error);\n    }\n  }\n\n  res.status(400).json({\n    message: \"expect a POST request\"\n  });\n}\n\nexport default handle;","map":{"version":3,"sources":["/home/rom/Documents/dev/nextjs/tuto/section9-apiRoutes/pages/api/registration/index.js"],"names":["mongoConnect","mongoEmailRegistrationHandler","handle","req","res","client","error","status","json","message","console","log","body","method","ans","email"],"mappings":"AAAA,SAAQA,YAAR,EAAsBC,6BAAtB,QAA0D,0BAA1D;;AAGA,eAAeC,MAAf,CAAsBC,GAAtB,EAA2BC,GAA3B,EAAgC;AAC5B,MAAIC,MAAJ;;AACA,MAAI;AACAA,IAAAA,MAAM,GAAG,MAAML,YAAY,EAA3B;AACH,GAFD,CAEE,OAAOM,KAAP,EAAc;AACZ,WAAOF,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,MAAAA,OAAO,EAAE;AAAV,KAArB,CAAP;AACH;;AACHC,EAAAA,OAAO,CAACC,GAAR,CAAYR,GAAG,CAACS,IAAhB;;AACA,MAAIT,GAAG,CAACU,MAAJ,KAAe,MAAnB,EAA2B;AACzB,QAAI;AACA,YAAMC,GAAG,GAAG,MAAMb,6BAA6B,CAACI,MAAD,EAAS,cAAT,EAAyBF,GAAG,CAACS,IAA7B,CAA/C;AACA,aAAOR,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC5BC,QAAAA,OAAO,EAAE,YADmB;AAE5BM,QAAAA,KAAK,EAAED;AAFqB,OAArB,CAAP;AAIH,KAND,CAME,OAAOR,KAAP,EAAc;AACZI,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBL,KAAtB;AACH;AAEF;;AACDF,EAAAA,GAAG,CAACG,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,IAAAA,OAAO,EAAE;AAAX,GAArB;AACD;;AAED,eAAeP,MAAf","sourcesContent":["import {mongoConnect, mongoEmailRegistrationHandler} from \"../../../helpers/mongodb\";\n\n\nasync function handle(req, res) {\n    let client\n    try {\n        client = await mongoConnect()\n    } catch (error) {\n        return res.status(400).json({message: \"cannot insert the document\"})\n    }\n  console.log(req.body);\n  if (req.method === \"POST\") {\n    try {\n        const ans = await mongoEmailRegistrationHandler(client, \"registration\", req.body)\n        return res.status(201).json({\n        message: \"registered\",\n        email: ans\n        });    \n    } catch (error) {\n        console.log('error ', error)\n    }\n    \n  }\n  res.status(400).json({ message: \"expect a POST request\" });\n}\n\nexport default handle;\n"]},"metadata":{},"sourceType":"module"}